/* static/css/scene.css */

/* General Scene Layout */
.scene-page-container {
    max-width: 1600px; 
    margin: 10px auto; /* Reduced top/bottom margin */
    padding: 15px; /* Reduced padding */
}

.scene-main-content {
    display: flex;
    flex-direction: column;
    gap: 20px; /* Reduced gap */
}

#current-scene-description-display {
    font-size: 1em; /* Slightly smaller */
    color: #c0c0c0; 
    margin-top: 0px; /* Reduced margin */
    margin-bottom: 15px; /* Reduced margin */
    font-style: italic;
    min-height: 1.2em; 
    text-align: center; 
    padding: 8px; /* Reduced padding */
    background-color: rgba(30, 30, 40, 0.5); 
    border: 1px solid #4a4166;
    border-radius: 4px;
}

.loading-npcs-message {
    text-align: center;
    font-size: 1.1em; /* Slightly smaller */
    padding: 20px; /* Reduced padding */
    color: #a0a0a0;
}

/* Grid for NPC Interaction Areas */
.npc-interaction-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(330px, 1fr)); /* Slightly smaller min-width */
    gap: 15px; /* Reduced gap */
    width: 100%;
}

/* Individual NPC Dialogue Container - The main "Chat Box" frame */
.npc-dialogue-container {
    background-color: #2c3e50; 
    border: 2px solid #7c90a0; /* Slightly thinner border */
    border-top-color: #a8c0d8; 
    border-left-color: #a8c0d8; 
    border-bottom-color: #4c6070; 
    border-right-color: #4c6070; 
    padding: 0; 
    border-radius: 4px; /* Slightly smaller radius */
    box-shadow: 1px 1px 4px rgba(0,0,0,0.3); /* Reduced shadow */
    display: flex;
    flex-direction: column; 
    min-height: 320px; /* Reduced min-height */
}

/* Header within each NPC's chat box */
.npc-header {
    display: flex;
    align-items: center;
    padding: 6px 10px; /* Reduced padding */
    background-color: #34495e; 
    border-bottom: 1px solid #7c90a0; /* Thinner separator */
    border-top-left-radius: 2px; 
    border-top-right-radius: 2px;
}

.npc-header-portrait {
    width: 36px; /* Slightly smaller portrait */
    height: 36px;
    border-radius: 2px; 
    object-fit: cover;
    border: 1px solid #a8c0d8; 
    margin-right: 8px; /* Reduced margin */
    flex-shrink: 0; 
    background-color: #2c3e50; 
}

.npc-header-name {
    font-family: 'Press Start 2P', cursive; 
    font-size: 0.9em; /* Slightly smaller name */
    color: #f1c40f; 
    text-shadow: 1px 1px #2c3e50; 
}

/* Individual Chat Log for each NPC */
.npc-chat-log { 
    flex-grow: 1; 
    min-height: 150px; /* Reduced min-height */
    max-height: 280px; /* Reduced max-height */
    overflow-y: auto; 
    padding: 10px; /* Reduced padding */
    background-color: #e4e0d8; 
    color: #2c3e50; 
    font-family: 'Noto Sans JP', 'VT323', sans-serif; 
    font-size: 16px; /* Slightly smaller font for dialogue */
    line-height: 1.45; /* Adjusted line height */
    border-bottom: 1px solid #7c90a0; /* Thinner separator */
}
.npc-chat-log .log-placeholder { 
    color: #666055; 
    font-style: italic;
    text-align: center;
    padding: 10px; /* Reduced padding */
    font-size: 0.9em;
}

/* Chat Entries and Bubbles */
.chat-entry {
    margin-bottom: 8px; /* Reduced space */
    display: flex; 
}

.chat-entry.npc .chat-bubble { 
    background-color: transparent; 
    border: none;
    padding: 0; 
    color: #2c3e50; 
}
.chat-entry.npc .chat-bubble .dialogue-text::before {
    content: "“"; 
    margin-right: 1px; /* Adjusted margin */
    font-weight: bold;
}
.chat-entry.npc .chat-bubble .dialogue-text::after {
    content: "”";
    margin-left: 1px; /* Adjusted margin */
    font-weight: bold;
}

.chat-entry.gm .chat-bubble, 
.chat-entry.system .chat-bubble,
.chat-entry.system-info .chat-bubble,
.chat-entry.system-error .chat-bubble,
.chat-entry.system-success .chat-bubble { 
    background-color: #d0c8bc; 
    border: 1px solid #b0a89c; 
    padding: 5px 8px; /* Reduced padding */
    border-radius: 3px; /* Smaller radius */
    color: #333; 
    font-size: 0.85em; /* Slightly smaller */
}
.chat-entry.system .chat-bubble { 
    font-style: italic;
    text-align: center;
}
.chat-entry.system-error .chat-bubble {
    color: #a94442; 
    background-color: #f2dede;
    border-color: #ebccd1;
}
.chat-entry.system-success .chat-bubble {
    color: #3c763d; 
    background-color: #dff0d8;
    border-color: #d6e9c6;
}
.chat-entry.npc-thinking .chat-bubble { 
    font-style: italic;
    color: #555045; 
    background-color: transparent;
    border: none;
    padding: 0;
}

.chat-bubble .speaker-name { 
    font-family: 'Press Start 2P', cursive;
    font-size: 0.8em; /* Slightly smaller */
    color: #4a4166; 
    margin-bottom: 2px; /* Reduced margin */
    display: block;
}
.chat-bubble .dialogue-text {
    white-space: pre-wrap; 
}

/* Dialogue Options (if displayed) */
.dialogue-options-container {
    margin-top: 8px; /* Reduced margin */
    padding: 8px; /* Reduced padding */
    background-color: rgba(44, 62, 80, 0.1); 
    border-top: 1px dashed #7c90a0;
}
.dialogue-options-title {
    font-family: 'Press Start 2P', cursive;
    font-size: 0.75em; /* Smaller title */
    color: #34495e; 
    margin-bottom: 6px; /* Reduced margin */
    text-align: center;
}
.dialogue-option.jrpg-button-small { 
    background-color: #7f8c8d; 
    color: #ecf0f1;
    border-color: #95a5a6;
    display: block; 
    width: 100%;
    margin-bottom: 4px; /* Reduced margin */
    padding: 5px 8px; /* Reduced padding */
    font-size: 0.9em; /* Ensure consistency with other small buttons */
}
.dialogue-option.jrpg-button-small:hover {
    background-color: #95a5a6;
    color: #2c3e50;
}

/* Controls below each NPC's chat log */
.npc-dialogue-controls {
    padding: 10px; /* Reduced padding */
    background-color: #34495e; 
    border-bottom-left-radius: 2px; 
    border-bottom-right-radius: 2px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); /* Smaller min button width */
    gap: 6px; /* Reduced gap */
}
.npc-dialogue-controls .jrpg-button-small {
    background-color: #7f8c8d; 
    color: #ecf0f1;
    border: 1px solid #95a5a6;
    font-size: 0.85em; /* Slightly smaller */
    padding: 5px 6px; /* Reduced padding */
}
.npc-dialogue-controls .jrpg-button-small:hover:not(:disabled) {
    background-color: #95a5a6;
    color: #2c3e50;
}

/* Scene Input Area */
.scene-input-area {
    background-color: #2c3e50; 
    border: 2px solid #7c90a0; 
    margin-top: 15px; /* Reduced margin */
    padding: 15px; /* Reduced padding */
}
.scene-input-area h2 { 
    font-family: 'Press Start 2P', cursive;
    color: #f1c40f; 
    font-size: 1.2em; /* Slightly smaller */
    margin-bottom: 10px; /* Reduced margin */
    text-align: center;
}
.jrpg-textarea { 
    background-color: #e4e0d8; 
    color: #2c3e50; 
    border: 2px solid #7c90a0; 
    font-family: 'Noto Sans JP', 'VT323', sans-serif; 
    font-size: 1em; /* Slightly smaller */
    min-height: 70px; /* Reduced min-height */
    padding: 8px; /* Reduced padding */
}
.jrpg-textarea:focus {
    border-color: #f1c40f; 
    box-shadow: 0 0 6px rgba(241, 196, 15, 0.5); /* Reduced shadow */
}
#start-scene-button { 
    display: block;
    margin: 15px auto 0 auto; /* Reduced top margin */
    padding: 10px 20px; /* Slightly smaller button */
    font-size: 0.95em; /* Slightly smaller font */
    background-color: #e74c3c; 
    color: #ffffff;
    border-color: #c0392b;
}
#start-scene-button:hover:not(:disabled) {
    background-color: #c0392b;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .npc-interaction-grid {
        grid-template-columns: 1fr; 
    }
    .npc-dialogue-controls {
        grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); 
    }
    .npc-dialogue-container {
        min-height: 300px; /* Further reduce min-height on small screens */
    }
    .npc-chat-log {
        min-height: 120px;
        max-height: 250px;
    }
}
